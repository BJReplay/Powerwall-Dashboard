[{"apiVersion":"influxdata.com/v2alpha1","kind":"Task","metadata":{"name":"practical-ride-7f7001"},"spec":{"every":"1m","name":"tesla_energy.alerts","query":"import \"date\"\n\n\nfrom(bucket: \"raw_tesla_energy\")\r\n//for historical generation change start here, otherwise use -2m for previous minute final total\r\n  |> range(start: date.truncate(t: -2m, unit: 1m), stop: date.truncate(t: now(), unit: 1m))\r\n  |> filter(fn: (r) => r[\"_measurement\"] == \"alerts\")\r\n  |> drop(columns: [\"host\", \"month\", \"url\", \"year\"])\r\n  |> aggregateWindow(every: 1m, fn: max, createEmpty: false)\r\n  |> drop(columns: [\"_start\", \"_stop\"])\r\n  |> to(bucket: \"tesla_energy\")"}}]